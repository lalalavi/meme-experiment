{% extends "global/Page.html" %}
{% load otree static %} 

{% block title %}
    Select a meme to post by pressing a number in your KEYBOARD
{% endblock %}

{% block content %}

{{ form.errors }}

<div id="fullbody">
  <div class="row">
      <div class="column">
        <div class="polaroid">
          <img id='memeshown1' src= {{ static Image }} value="1" style="width:100%">
          <div class="container">
            <p>1</p>
          </div>
        </div>
      </div>
      <div class="column">
        <div class="polaroid">
          <img id='memeshown2' src= {{ static Image2 }} value="2" style="width:100%">
          <div class="container">
            <p>2</p>
          </div>
        </div>
      </div>
      <div class="column">
        <div class="polaroid">
          <img id='memeshown3' src= {{ static Image3 }} value="3" style="width:100%">
          <div class="container">
            <p>3</p>
          </div>
        </div>
      </div>
  </div>

  <div class="row">
      <div class="column">
        <div class="polaroid">
          <img id='memeshown4' src= {{ static Image4 }}  value="4" style="width:100%">
          <div class="container">
            <p>4</p>
          </div>
        </div>
      </div>
      <div class="column">
        <div class="polaroid">
          <img id='memeshown5' src= {{ static Image5 }}  value="5" style="width:100%">
          <div class="container">
            <p>5</p>
          </div>
        </div>
      </div>
      <div class="column">
        <div class="polaroid">
          <img id='memeshown6' src= {{ static Image6 }}  value="6" style="width:100%">
          <div class="container">
            <p>6</p>
          </div>
        </div>
      </div>
  </div>
</div>

{% block app_styles %}
    <link href="{% static 'global/css/FriendlyChecks.css' %}" rel="stylesheet">
{% endblock %}
 
 
 <style>


/* Three image containers (use 25% for four, and 50% for two, etc) */
.column {
    float: left;
    width: 33.33%;
    padding: 5px;
  } 
  /* Clear floats after image containers */
  .row::after {
    content: "";
    clear: both;
    display: table;
    }

.row {
  display: flex;
}

.column {
  flex: 33.33%;
  padding: 5px;
}

body {margin:25px;}

div.polaroid {
  width: 80%;
  background-color: white;
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  margin-bottom: 25px;
}

div.container {
  text-align: center;
  padding: 10px 20px;
}

.otree-timer {
    display: none;
}

.debug-info {
    display:none;
}
</style>

<script src="{% static 'global/js/FriendlyChecks.js' %}"></script> 

<script> 
const bRequireFS    = js_vars.bRequireFS;
const bCheckFocus   = js_vars.bCheckFocus;
const defaultPixel  = js_vars.dPixelRatio;
var TBlur           = new Date().getTime();
var TFocus          = new Date().getTime();

    // Hidden Next Button
    let EndButton               = document.createElement('button');
    EndButton.style.visibility  = 'hidden';
    EndButton.className         = 'next_button btn btn-primary btn-large';

    // Create hidden input (Decision)
    let iPost        = document.createElement("input");
    iPost.type       = 'hidden';
    iPost.name       = 'iPost';
    iPost.id         = 'iPost';
    iPost.value      = '';

    let dRT          = document.createElement("input");
    dRT.type         = 'hidden';
    dRT.name         = 'dRTPost';
    dRT.id           = 'dRTPost';
    dRT.value        = '';
    var TStart       = new Date().getTime();
    var TEnd         = new Date().getTime();

    document.addEventListener("DOMContentLoaded", function(debug=false) {
        console.log('Loading info');

        let fullbody = document.getElementById('fullbody');
        InitializeFriendlyChecks(fullbody, bRequireFS, bCheckFocus);

        let OtreeBody     = document.getElementsByClassName("_otree-content")[0];
        OtreeBody.appendChild(iPost);
        OtreeBody.appendChild(dRT);
        OtreeBody.appendChild(EndButton);

        // take variables from python into javascript
        let ImageID = js_vars.ImageID;
        let Image2ID = js_vars.Image2ID;
        let Image3ID = js_vars.Image3ID;
        let Image4ID = js_vars.Image4ID;
        let Image5ID = js_vars.Image5ID;
        let Image6ID = js_vars.Image6ID;

        // Add event listener for pressing numbers
        document.addEventListener("keyup", function(event) {
            console.log(event.key);
        if (event.key === '1')   {
            // change input value
            iPost.value = ImageID ;
            console.log('1 was pressed');
            TEnd      = new Date().getTime();
            dRT.value = +TEnd -TStart;
            // press next button
            EndButton.click();
        }
        if (event.key === '2') {
            iPost.value = Image2ID;
            console.log('2 was pressed');
            TEnd      = new Date().getTime();
            dRT.value = +TEnd -TStart;
            EndButton.click();
        } 
        if (event.key === '3') {
            iPost.value = Image3ID;
            console.log('3 was pressed');
            TEnd      = new Date().getTime();
            dRT.value = +TEnd -TStart;
            EndButton.click();
        }
        if (event.key === '4') {
            iPost.value = Image4ID;
            console.log('4 was pressed');
            TEnd      = new Date().getTime();
            dRT.value = +TEnd -TStart;
            EndButton.click();
        }
        if (event.key === '5') {
            iPost.value = Image5ID;
            console.log('5 was pressed');
            TEnd      = new Date().getTime();
            dRT.value = +TEnd -TStart;
            EndButton.click();
        }
        if (event.key === '6') {
            iPost.value = Image6ID;
            TEnd      = new Date().getTime();
            dRT.value = +TEnd -TStart;
            console.log('6 was pressed');
            EndButton.click();
        }});
    });
</script>  

{% endblock %}
